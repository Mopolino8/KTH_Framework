<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>KTH framework for Nek5000 toolboxes; testing version: Nek5000/tools/postnek/xinterface.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KTH framework for Nek5000 toolboxes; testing version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('postnek_2xinterface_8f_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">xinterface.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="postnek_2xinterface_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a426f6a66b6bd76fb526ac94861bcd52e">    1</a></span>&#160;      <span class="keyword">PROGRAM</span> <a class="code" href="postnek_2xinterface_8f.html#a426f6a66b6bd76fb526ac94861bcd52e">mainf</a></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">c     Default window size</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">c     call set_ww_wh(ww,wh)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">c     call set_ww_wh(850,800)</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;      <span class="keyword">call </span>set_ww_wh(950,920)  <span class="comment">! std</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">c     call set_ww_wh(850,825)</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">c     call set_ww_wh(730,710)</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">c     Start nekton</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keyword">CALL </span>mainc</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      stop</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a596f66905e108f0c942d832dc3f7b31c">reader</a>(VALUE,IERR)</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a596f66905e108f0c942d832dc3f7b31c">   18</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      ierr=0</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      rewind(13)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="keyword">WRITE</span>(13,<span class="stringliteral">&#39;(A70)&#39;</span>)line        </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      rewind(13)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <span class="keywordflow">IF</span>(line.EQ.<span class="stringliteral">&#39; &#39;</span>)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;         <span class="keywordtype">VALUE</span>=0</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;         <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keyword">READ</span>(13,*,err=2,end=2)<span class="keywordtype">VALUE</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      rewind(13)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;2     ierr=1</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a193d34f29f39adf341ebfb71fadede70">openf</a>(IUNIT,FILE,STATUS,ITYPE,IERR)</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a193d34f29f39adf341ebfb71fadede70">   35</a></span>&#160;      <span class="keywordtype">CHARACTER*(*)</span> FILE,STATUS</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordtype">CHARACTER*30</span> NEWFILE,LFILE</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordtype">CHARACTER</span> NULL</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">C     NULL out local filename character strings</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      null = char(0)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">DO</span> 5 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=1,30</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         lfile(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>:<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>) = null</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         newfile(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>:<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>) = null</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;5     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      lfile = <a class="code" href="structfile.html">file</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">IF</span>(status.EQ.<span class="stringliteral">&#39;NEW&#39;</span> .OR. status.EQ.<span class="stringliteral">&#39;new&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;           newfile=<a class="code" href="structfile.html">file</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;           <span class="keywordflow">do</span> 10 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=30,1,-1</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;              <span class="keywordflow">if</span>(ichar(newfile(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>:<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)).ne.0.and.newfile(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>:<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>).ne.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">then</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                 newfile(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>+1:<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>+1) = <span class="stringliteral">&#39;~&#39;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                 <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordflow">              endif</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; 10           <span class="keywordflow">continue</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; 20           <span class="keywordflow">continue</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;           print*,<span class="stringliteral">&#39;renaming &#39;</span>,<a class="code" href="structfile.html">file</a>,<span class="stringliteral">&#39; &#39;</span>,newfile</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c          MVERR=RENAME(FILE,NEWFILE)</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">OPEN</span>(unit=iunit,<a class="code" href="structfile.html">file</a>=lfile,status=status,err=1)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        ierr=0</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;1       ierr=1</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">        END</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a5750532c6abc6ee8f8826bf03018684f">findfl</a>(SESION,OLDVER)</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a5750532c6abc6ee8f8826bf03018684f">   67</a></span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">        END</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a6f045724a49b3303493e5814692ba706">mouse</a>(XMOUSE,YMOUSE,BUTTON)</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a6f045724a49b3303493e5814692ba706">   71</a></span>&#160;        include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">INTEGER*4</span> RECORD(3),SIZE,PET</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">INTEGER</span> ERRIND,MODE,ESW,XFORM,LDR,RETSIZ,ISTAT,DEVNO</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">REAL</span> LOCX,LOCY,EAREA(4)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        common/mousefac/ window</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">C                                                Universal</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">C       BUTTON only recorded in interactive mode, not from journal</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">C       BUTTON=&#39; &#39; for typed in input or when reading from journal</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">C       BUTTON=&#39;LEFT&#39;,&#39;RIGHT&#39;, or &#39;MIDDLE&#39;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">C   NEW! IMPROVED!!! Green button means &quot;EXIT&quot; end, etc</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">C       Return XMOUSE,YMOUSE, BUTTON; backspace and write x,y in journal file</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;20      <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">C       Look for button input on SUN</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;97      <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (.not.ifgraf) <span class="keywordflow">then</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;           <span class="keyword">call </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;lmr? (left, middle, right)$&#39;</span>)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;           <span class="keyword">call </span><a class="code" href="postnek_2iolib_8f.html#a1e12d5f0a58f8389eff1920b1ce03e59">res</a>(ans,1)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;           button = <span class="stringliteral">&#39;LEFT&#39;</span>   <span class="comment">! default </span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c          if (ans.eq.&#39;l&#39; .or. ans.eq.&#39;L&#39;) button = &#39;LEFT&#39;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;           <span class="keywordflow">if</span> (ans.eq.<span class="stringliteral">&#39;m&#39;</span> .or. ans.eq.<span class="stringliteral">&#39;M&#39;</span>) button = <span class="stringliteral">&#39;MIDDLE&#39;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;           <span class="keywordflow">if</span> (ans.eq.<span class="stringliteral">&#39;r&#39;</span> .or. ans.eq.<span class="stringliteral">&#39;R&#39;</span>) button = <span class="stringliteral">&#39;RIGHT&#39;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;           <span class="keywordflow">return</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">IF</span>(.NOT.ifdemo)<span class="keyword">call </span>xwaitm(ibutton,xm,ym)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">C       IF(     IFDEMO)CALL XWAITM(IBUTTON,XM,YM)</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">IF</span>(     ifdemo)<span class="keyword">READ</span>(55,*)ibutton,xm,ym</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">c       IF(     IFDEMO)READ(5,*)IBUTTON,XM,YM</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">IF</span>(iflearn)<span class="keyword">WRITE</span>(3,*)ibutton,xm,ym</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span>(ibutton.eq.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;Still waiting for mouse input$&#39;</span>)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           <span class="keywordflow">go to</span> 97</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordflow">    endif</span>   </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">IF</span>(ibutton.EQ.1)button=<span class="stringliteral">&#39;LEFT&#39;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">IF</span>(ibutton.EQ.2)button=<span class="stringliteral">&#39;MIDDLE&#39;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">IF</span>(ibutton.EQ.3)button=<span class="stringliteral">&#39;RIGHT&#39;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    window=1.3</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        xscreen=(xm/windoww*window) </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        yscreen=(ym/(windowh-180.))-0.05</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">C     OLD VERSION -- coordinate transformation is almost</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">C                    device dependent!</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">C        YSCREEN=((YM-12)/1000.0*WINDOW) + 0.015</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">IF</span>(xscreen .EQ. oldxscreen .AND.</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     $     yscreen .EQ. oldyscreen .AND. </div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     $     choice  .EQ.<span class="stringliteral">&#39;ACCEPT CURRENT SWITHCES&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;Error reading mouse input; please move mouse&#39;</span>//</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     $              <span class="stringliteral">&#39;slightly and re-enter$&#39;</span>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;           <span class="keywordflow">GO TO</span> 97</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        oldxscreen = xscreen</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        oldyscreen = yscreen</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">IF</span>(xscreen .LT. 0.0 .OR. xscreen .GT. 1.3  .OR.</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     $     yscreen .LT. 0.0 .OR. yscreen .GT. 1.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;Error reading mouse input; please re-enter$&#39;</span>)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;           <span class="keywordflow">GO TO</span> 97</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">IF</span>(xscreen .EQ. 0.0 .AND. yscreen .EQ. 1.5e-2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;Mouse not activated; please move mouse slightly&#39;</span>//</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     $          <span class="stringliteral">&#39;and re-enter$&#39;</span>)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;           <span class="keywordflow">GO TO</span> 97</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">C       FILTER X,Y THRU GRID</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        grid=param(18)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">IF</span> (grid.LT. .0099) ifgrdc=.false.</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">C       Filter Only if building and outside build menu area.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">IF</span>(xscreen.LT.1.0 .AND.ifgrid.AND.button.NE.<span class="stringliteral">&#39;RIGHT&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2screen_8f.html#aec8a2fb255b1dfc7e4fe074bde83b491">filter</a>(xmouse,ymouse,xscreen,yscreen)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;           xmouse=<a class="code" href="postnek_2plot_8f.html#a4ec54acb6421be2555cd3efe39ba3510">xphy</a>(xscreen)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;           ymouse=<a class="code" href="postnek_2plot_8f.html#a1bf5e8e41f48c165cf50c832d2f8365e">yphy</a>(yscreen)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">IF</span>(button.EQ.<span class="stringliteral">&#39;MIDDLE&#39;</span>)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#a759604523225e83e92645afd6606767b">prsr</a>(<span class="stringliteral">&#39;Cursor Coordinates: x: $&#39;</span>,xmouse)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;           <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#a759604523225e83e92645afd6606767b">prsr</a>(<span class="stringliteral">&#39;Cursor Coordinates: y: $&#39;</span>,ymouse)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;           <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(button.EQ.<span class="stringliteral">&#39;LEFT&#39;</span>.OR.button.EQ.<span class="stringliteral">&#39;RIGHT&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">        END</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#af4175a8271d4629a40d42ae159daac36">move</a>(X,Y)</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#af4175a8271d4629a40d42ae159daac36">  156</a></span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#a22eca17c14bd8636f3cae9df2af7bda8">movesc</a>(<a class="code" href="postnek_2plot_8f.html#a7c5267c7b190489d891d2251b0661e11">xscr</a>(x),<a class="code" href="postnek_2plot_8f.html#ac1101d6cdf0422a116a79b4da4cb5947">yscr</a>(y))</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a3a5a1a06a63d2f4da08eacd2ad4e12e2">draw</a>(X,Y)</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a3a5a1a06a63d2f4da08eacd2ad4e12e2">  161</a></span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#aca8979e3f74809654f66e0294f7dde7b">drawsc</a>(<a class="code" href="postnek_2plot_8f.html#a7c5267c7b190489d891d2251b0661e11">xscr</a>(x),<a class="code" href="postnek_2plot_8f.html#ac1101d6cdf0422a116a79b4da4cb5947">yscr</a>(y))</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a22eca17c14bd8636f3cae9df2af7bda8">movesc</a>(X,Y)</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a22eca17c14bd8636f3cae9df2af7bda8">  166</a></span>&#160;<span class="comment">C     Moves with &quot;Pen up&quot;, no line Drawn  IN SCREEN COORDINATES</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">CHARACTER</span> STRING*5</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">COMMON</span> /fill/ icfill,<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>,nfill,xfill(210),yfill(210)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>.NE.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">C          Currently Filling region defined by moves and draws</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;           <span class="keywordflow">IF</span>(nfill.GT.210)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">C             Forgot somewhere to shut off fill</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;              <a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>=0</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;              nfill=0</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordflow">           ENDIF</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;           nfill = nfill+1</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;           xfill(nfill) = <a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(x)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;           yfill(nfill) = <a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(y)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keyword">CALL </span>xmove(<a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(x),<a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(y))</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">c     write(6,*) ifposts,ifhard,ifhard0</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">IF</span>(ifposts.AND.ifhard.AND.ifhard0)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     $<span class="keyword">WRITE</span>(45,<span class="stringliteral">&#39;(2F10.3,A3)&#39;</span>)<span class="keywordtype">REAL(550-Y*500)</span>,<span class="keywordtype">REAL(X*500+50)</span>,<span class="stringliteral">&#39; m &#39;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">c12/23/92/pff $WRITE(45,&#39;(2F10.3,A6)&#39;)REAL(550-Y*500),REAL(X*500+50),&#39; move &#39;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#aca8979e3f74809654f66e0294f7dde7b">drawsc</a>(X,Y)</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#aca8979e3f74809654f66e0294f7dde7b">  192</a></span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">C     Draws lines for various devices with &quot;Pen down&quot; IN SCREEN COORDINATES</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">CHARACTER</span> STRING*5</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">COMMON</span> /fill/ icfill,<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>,nfill,xfill(210),yfill(210)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>.NE.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">C          Currently Filling region defined by moves and draws</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;           <span class="keywordflow">IF</span>(nfill.GT.210)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">C             Forgot somewhere to shut off fill</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;              <a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>=0</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;              nfill=0</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;              <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordflow">           ENDIF</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;           nfill = nfill+1</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;           xfill(nfill) = <a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(x)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;           yfill(nfill) = <a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(y)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">CALL </span>xdrawto(<a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(x),<a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(y))</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">IF</span>(ifposts.AND.ifhard.AND.ifhard0)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     $<span class="keyword">WRITE</span>(45,<span class="stringliteral">&#39;(2F9.3,A3)&#39;</span>)<span class="keywordtype">REAL(550-Y*500)</span>,<span class="keywordtype">REAL(X*500+50)</span>,<span class="stringliteral">&#39; d &#39;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">c12/23/92/pff $WRITE(45,&#39;(2F9.3,A6)&#39;)REAL(550-Y*500),REAL(X*500+50),&#39; draw &#39;</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a38427b6d929242043fdbf5db9659829a">beginp</a>(X1,Y1)</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a38427b6d929242043fdbf5db9659829a">  218</a></span>&#160;<span class="comment">C     Begins panel for fill  NO BOUNDARY DISPLAY</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordtype">LOGICAL</span> IFTMP </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">CHARACTER</span> STRING*5</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">COMMON</span> /fill/ icfill,<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>,nfill,xfill(210),yfill(210)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      x=(x1-xzero)/xfac</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      y=(y1-yzero)/yfac</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      icfill=0</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a> = 1</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      nfill = 0</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2screen_8f.html#a3e45780304d09016ede43bfed04b87ad">movec</a>(x1,y1)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      iftmp=ifhard</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      ifhard=.false.</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#af4175a8271d4629a40d42ae159daac36">move</a>(x1,y1)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      ifhard=iftmp</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a7c6bc0acf46b543c61b1bcf3bf2d4aea">beginb</a>(X1,Y1)</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a7c6bc0acf46b543c61b1bcf3bf2d4aea">  239</a></span>&#160;<span class="comment">C     Begins panel for fill WITH BOUNDARY DISPLAY</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordtype">CHARACTER</span> STRING*5</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keyword">COMMON</span> /fill/ icfill,<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>,nfill,xfill(210),yfill(210)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordtype">LOGICAL</span> IFTMP </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      x=(x1-xzero)/xfac</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      y=(y1-yzero)/yfac</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      icfill=1</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a> = 1</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      nfill = 0</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2screen_8f.html#a3e45780304d09016ede43bfed04b87ad">movec</a>(x1,y1)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      iftmp=ifhard</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      ifhard=.false.</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#af4175a8271d4629a40d42ae159daac36">move</a>(x1,y1)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      ifhard=iftmp</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="postnek_2xinterface_8f.html#a63fa5cf04bc83798c24cb461e1480d4d">gnable</a></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a63fa5cf04bc83798c24cb461e1480d4d">  258</a></span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">      end</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ad2877f474c84841527bf45063eead230">gindis</a></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ad2877f474c84841527bf45063eead230">  262</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="postnek_2xinterface_8f.html#a695401e16569d5d76bece71dac5e247b">sgvis</a>(iseg,ivisibility)</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a695401e16569d5d76bece71dac5e247b">  266</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ace50d35a4d95824d5c9c6f948a90eb05">heject</a></div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ace50d35a4d95824d5c9c6f948a90eb05">  270</a></span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">C     EJECTS page from hard copy laser, and closes/opens new plot file</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordtype">character*6</span>  s6</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">character*7</span>  s7</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordtype">character*40</span> fname</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">character*1</span>  fname1(40)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      equivalence(fname,fname1)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">IF</span>(ifhard.AND.ifhard0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">c        IF(IFPOSTS)WRITE(45,*)&#39; showpage&#39;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">c        IF(IFPOSTS)CALL PENW(3)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keywordflow">IF</span> (ifposts) <span class="keywordflow">then</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keyword">WRITE</span>(45,*)<span class="stringliteral">&#39; showpage&#39;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keyword">close</span>(unit=45)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">c           Update filename stuff for successive plot files</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            fname    = fplotnam</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            m        = iplotnam</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            iplotnum = iplotnum+1</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">if</span> (iplotnum.le.99) <span class="keywordflow">then</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;               <span class="keyword">write</span>(s6,6) iplotnum</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    6          <span class="keyword">format</span>(<span class="stringliteral">&#39;.plt&#39;</span>,i2.2)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">c              fname(m:m+5)=s6</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;               <span class="keyword">call </span><a class="code" href="math_8f.html#ad7fb480cea001849621405f37167aab1">chcopy</a>(fname1(m),s6,6)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;               <span class="keyword">write</span>(s7,7) iplotnum</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    7          <span class="keyword">format</span>(<span class="stringliteral">&#39;.plt&#39;</span>,i3.3)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">c              fname(m:m+6)=s7</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               <span class="keyword">call </span><a class="code" href="math_8f.html#ad7fb480cea001849621405f37167aab1">chcopy</a>(fname1(m),s7,7)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#a193d34f29f39adf341ebfb71fadede70">openf</a>(45,fname,<span class="stringliteral">&#39;NEW&#39;</span>,3,ierr)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keyword">CALL </span><a class="code" href="postnek_2plot_8f.html#aa6e27b432aef95cb707060fe995d2c08">initps</a></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#a21c6581ab8e6c8b00b145d9154e97857">penw</a>(3)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordflow">         endif</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         <span class="keywordflow">IF</span>(iflase)<span class="keyword">WRITE</span>(45,*)<span class="stringliteral">&#39; ^,&#39;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ae0c6177f95f334270fac9f198fd4ed4a">clsseg</a></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ae0c6177f95f334270fac9f198fd4ed4a">  319</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a5ed3357d34a64f0a92311b5cd074f472">opnseg</a>(ISEG)</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a5ed3357d34a64f0a92311b5cd074f472">  323</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a20a0d5df1d6d4e82ccd41605af3070d4">delseg</a>(ISEG)</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a20a0d5df1d6d4e82ccd41605af3070d4">  327</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a21c6581ab8e6c8b00b145d9154e97857">penw</a>(IWIDTH)</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a21c6581ab8e6c8b00b145d9154e97857">  331</a></span>&#160;<span class="comment">C     Sets Pen width of laser. IWIDTH should be an odd integer 1 to 31</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">C     Default is 3.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordtype">INTEGER</span> IWDOLD</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordtype">SAVE</span>    iwdold</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">DATA</span>    iwdold /-99999/ </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">IF</span> (iwidth.EQ.iwdold) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      iwdold=iwidth</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">IF</span>(ifhard.AND.ifhard0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">IF</span>(ifposts)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     $    <span class="keyword">WRITE</span>(45,<span class="stringliteral">&#39;(f7.2,a14)&#39;</span>)<span class="keywordtype">REAL(IWIDTH/15.)</span>,<span class="stringliteral">&#39; setlinewidth &#39;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">IF</span>(iflase)<span class="keyword">WRITE</span>(45,100) iwidth</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;100   <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39; ^PW&#39;</span>,i2.2)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keyword">      SUBROUTINE </span>scroll(ILINES)</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a58732143c9584ed7a3c8361235c93480">  350</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ae90c289bf6fbea3bd3aca5392a653718">rubber</a></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ae90c289bf6fbea3bd3aca5392a653718">  354</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a7b7e7625cd6f6ff7e544f40c9aa4fd03">offrub</a></div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a7b7e7625cd6f6ff7e544f40c9aa4fd03">  358</a></span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ae0a3a2ae9aee23121a61b3802d0826df">gwrite</a>(X,Y,SIZE,STRING)</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ae0a3a2ae9aee23121a61b3802d0826df">  362</a></span>&#160;      <span class="keywordtype">CHARACTER</span> STRING(100)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keyword">COMMON</span> /clip/ xmovec,ymovec,wt,wb,wl,wr</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#a15b1e6ead87be733cf1f84db272e6f09">gswrit</a>(<a class="code" href="postnek_2plot_8f.html#a7c5267c7b190489d891d2251b0661e11">xscr</a>(x),<a class="code" href="postnek_2plot_8f.html#ac1101d6cdf0422a116a79b4da4cb5947">yscr</a>(y),<span class="keyword">SIZE</span>,string)     </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">c     changed 2/27/00 pff</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">c     if ((wl.lt.x.and.x.lt.wr) .and. (wb.lt.y.and.y.lt.wt)) </span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">c    $   CALL GSWRIT(XSCR(X),YSCR(Y),SIZE,STRING)     </span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">      END      </span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a15b1e6ead87be733cf1f84db272e6f09">gswrit</a>(X,Y,SIZE,STRING)</div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a15b1e6ead87be733cf1f84db272e6f09">  372</a></span>&#160;      <span class="keywordtype">CHARACTER</span> STRING(100),DIR,STRING2(100)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">COMMON</span> /font/ ifont,idir</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keyword">DATA</span> ifont,idir /204,1/</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      null=char(0)</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">DO</span> 1 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=1,100</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          string2(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)=string(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          <span class="keywordflow">IF</span>(string(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>).EQ.<span class="stringliteral">&#39;$&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                string2(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)=null</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                nchars=<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>-1</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">GO TO</span> 2</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keywordflow">          ENDIF</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;1     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keyword">CALL </span><a class="code" href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a>(<span class="stringliteral">&#39;PUT DOLLAR SIGN AFTER LAST CHARACTER!$&#39;</span>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;2     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keyword">CALL </span>xputxt(<a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(x),<a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(y),<span class="keyword">SIZE</span>,string2,nchars)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">IF</span>(ifposts.AND.ifhard.AND.ifhard0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          <span class="keyword">CALL </span><a class="code" href="postnek_2xinterface_8f.html#a22eca17c14bd8636f3cae9df2af7bda8">movesc</a>(x,y)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keyword">write</span>(45,*)<span class="stringliteral">&#39; 90 rotate&#39;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="keyword">write</span>(45,<span class="stringliteral">&#39;(80A1)&#39;</span>) <span class="stringliteral">&#39;(&#39;</span>,(string(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>),<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=1,nchars),<span class="stringliteral">&#39;)&#39;</span>,<span class="stringliteral">&#39; &#39;</span>,<span class="stringliteral">&#39;s&#39;</span>,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     $    <span class="stringliteral">&#39;h&#39;</span>,<span class="stringliteral">&#39;o&#39;</span>,<span class="stringliteral">&#39;w&#39;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="keyword">write</span>(45,*)<span class="stringliteral">&#39;-90 rotate&#39;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;5     <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a9d2cacaa7326eca04d8026bfc9db553e">devini</a>(DEVICE)</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a9d2cacaa7326eca04d8026bfc9db553e">  399</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      ifnoseg= .true.</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      ifxwin = .true.</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keyword">CALL </span>getwin(xsize,ysize)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      windoww=xsize</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      windowh=ysize</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">c     Pixel map default size</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      xpmn = 0.</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      ypmn = 0.</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      xpmx = xsize</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      ypmx = ysize</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keyword">CALL </span>xplanes(nplanes)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      ifbwgks = .false.</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">IF</span>(nplanes .EQ. 1) ifbwgks = .true.</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#aeab7bd96074585409ad27f123844bca5">devex</a></div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#aeab7bd96074585409ad27f123844bca5">  424</a></span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">C     Set Screen to scroll</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">IF</span>(ifposts)<span class="keyword">WRITE</span>(45,*)<span class="stringliteral">&#39; showpage&#39;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">IF</span>(ifposts)       <span class="keyword">CLOSE</span>(unit=45)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">CALL </span>closew</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a5d1d5eed3065d1ccf65bb3d010226db0">endp</a></div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a5d1d5eed3065d1ccf65bb3d010226db0">  434</a></span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keyword">COMMON</span> /fill/ icfill,<a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a>,nfill,xfill(210),yfill(210)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">IF</span> (nfill.GT.210) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         nfill=210 </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         xfill(nfill)=xfill(1)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         yfill(nfill)=yfill(1)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keyword">CALL </span>xpoly(xfill,yfill,nfill,icfill)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a> = 0</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      ndraw = nfill</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      nfill = 0</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a27cb1da06839d074efcde9d4998103ee">fillp</a>(ICOLOR)</div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a27cb1da06839d074efcde9d4998103ee">  449</a></span>&#160;<span class="comment">C     SELECTS FILL panel</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordtype">CHARACTER</span> STRING*5</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keyword">CALL </span>xsetfill(<a class="code" href="types_8h.html#a4e78ddb52240687b065c7889e7ab5b99">iabs</a>(icolor))</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#a316de98d896ad9f6d11240c49155d919">clear</a></div><div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a316de98d896ad9f6d11240c49155d919">  457</a></span>&#160;<span class="comment">C     clears screen (graphics portion)</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">if</span> (ifrevbk) <span class="keywordflow">then</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;         iback = 1</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;         iback = 0</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">c     write(6,*) &#39;call xclear:&#39;,iback,ifrevbk</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keyword">CALL </span>xclear(iback)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#abcb68fde09eff27e4f21ef3810cd8200">cleara</a></div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#abcb68fde09eff27e4f21ef3810cd8200">  471</a></span>&#160;<span class="comment">C     clears screen</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">CALL </span>xcleara</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="lanczos_8c.html#ab7e14c80140565c8e9b50fdbf5b17995">color</a>(Incolor)</div><div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a01b5cad803efe1373b722dfdef7d8945">  477</a></span>&#160;<span class="comment">C     SETS COLOR OF LINES TO BE</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">C     WHICHEVER DRAW IS TO BE THIS COLOR</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      equivalence(ccolor,icdum)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      include <span class="stringliteral">&#39;devices.inc&#39;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">c     character*4 colors(0:200),ccolor</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">CHARACTER*3</span> COLORS(0:200),CCOLOR</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordtype">logical</span> lrevbk</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">C     Save color for use with IFSAVE DRAW option.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">IF</span> (incolor.EQ.lstclr) <span class="keywordflow">return</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">c     IF (InCOLOR.EQ.LSTCLR  .and.</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">c    $   ((ifrevbk.and.lrevbk).or..not.(ifrevbk.or.lrevbk)) ) RETURN</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">c     write(6,*) &#39;this is incolor&#39;,incolor,ifrevbk</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">c     lrevbk = ifrevbk</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      lstclr=incolor</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      icolor = incolor</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      ncolor = 15</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      icolor = max(icolor,0)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      icolor = min(icolor,ncolor)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      icdum  = icolor</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      index=icolor</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">IF</span>(ifbwgks .AND. icolor .NE.0) index=1</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span> (ifrevbk) <span class="keywordflow">then</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">c        Reverse for white background, black lines</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         colors(1)=<span class="stringliteral">&#39;BLACK&#39;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         colors(0)=<span class="stringliteral">&#39;WHITE&#39;</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         <span class="keywordflow">if</span> (incolor.eq.0) icolor = 1</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;         <span class="keywordflow">if</span> (incolor.eq.1) icolor = 0</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         index=icolor</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">c        Standard</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;         colors(0)=<span class="stringliteral">&#39;BLACK&#39;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         colors(1)=<span class="stringliteral">&#39;WHITE&#39;</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      colors(2)=<span class="stringliteral">&#39;RED&#39;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      colors(3)=<span class="stringliteral">&#39;GREEN&#39;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      colors(4)=<span class="stringliteral">&#39;BLUE&#39;</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      colors(5)=<span class="stringliteral">&#39;LTBLUE&#39;</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      colors(6)=<span class="stringliteral">&#39;PURPLE&#39;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      colors(7)=<span class="stringliteral">&#39;YELLOW&#39;</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      colors(8)=<span class="stringliteral">&#39;ORANGE&#39;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      colors(9)=<span class="stringliteral">&#39;GREEN&#39;</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      colors(10)=<span class="stringliteral">&#39;LTGREEN&#39;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      colors(11)=<span class="stringliteral">&#39;MEDBLUE&#39;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      colors(12)=<span class="stringliteral">&#39;VIOLET&#39;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      colors(13)=<span class="stringliteral">&#39;PINK&#39;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      colors(14)=<span class="stringliteral">&#39;GRAY&#39;</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      colors(15)=<span class="stringliteral">&#39;LGRAY&#39;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">DO</span> 1 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=0,ncolor</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          <span class="keywordflow">IF</span>(ccolor.EQ.colors(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)) index=<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;1     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keyword">CALL </span>xsetpen(index)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">c     write(6,*) index,incolor,&#39; color&#39;</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="postnek_2xinterface_8f.html#ac0cb670d44c351b4b6b36e1355f129d2">clrmap</a>(TYPE)</div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ac0cb670d44c351b4b6b36e1355f129d2">  550</a></span>&#160;      <span class="keywordtype">CHARACTER*4</span> TYPE</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordtype">REAL</span> RED(0:15),GREEN(0:15),BLUE(0:15)</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordtype">REAL</span> MESHMP(4,0:15),HEATMP(4,0:15)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">C      DATA MESHMP / 0,      0,       0,       0,</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">C     $            1,      61440,   61440,   61440,</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">C     $            2,      61440,   0,       0,</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">C     $            3,      0,       61440,   0,</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">C     $            4,      0,       0,       61440,</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">C     $            5,      12288,   40960,   53248,</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">C     $            6,      40960,   12288,   53248,</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">C    $            7,      61440,   61440,   0,</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">C     $            8,      61440,   32748,   0,</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">C     $            9,      0,       61440,   0,</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">C     $            10,     0,       61440,   32768,</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">C     $            11,     12288,   12288,   53248,</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">C     $            12,     20480,   12288,   20480,</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">C     $            13,     61440,   0,       61440,</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">C     $            14,     20480,   20480,   20480,</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">C     $            15,     45056,   45056,   45056  /</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">C                         RED      GREEN    BLUE</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">C      DATA HEATMP / 0,      0,       0,       0,</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">C     $            1,      61440,   61440,   61440,</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">C     $            2,      61440,   0,       0,</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">C     $            3,      0,       61440,   0,</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">C     $            4,      0,       0,       61440,</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">C     $            5,      12288,   40960,   53248,</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">C     $            6,      40960,   12288,   53248,</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">C     $            7,      61440,   61440,   0,</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">C     $            8,      61440,   32748,   0,</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">C     $            9,      0,       61440,   0,</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">C     $            10,     0,       61440,   32768,</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">C     $            11,     12288,   12288,   53248,</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">C     $            12,     20480,   12288,   20480,</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">C     $            13,     61440,   0,       61440,</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">C     $            14,     20480,   20480,   20480,</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">C     $            15,     45056,   45056,   45056  /</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">C                         RED      GREEN    BLUE</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keyword">DATA</span> meshmp /    0.,      .1,    .1,   .1,</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     $                 1.,      1.0,    1.0,   1.0,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;     $                  2.,      1.0,    0.0,   0.0,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     $                  3.,      1.0,    1.0,   0.0,</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     $                  4.,      0.5,    0.5,   0.5,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     $                  5.,      0.0,    .0,     1.0,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     $                  6.,      1.0,    0.0,   0.7,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     $                  7.,      1.0,    1.0,   0.0,</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;     $                  8.,      0.7,    1.0,   0.0,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;     $                  9.,      0.2,    1.0,   0.2,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;     $                  10.,     0.0,    1.0,   1.0,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;     $                  11.,     0.0,    0.3,   1.0,</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     $                  12.,     1.0,    0.0,   1.0,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;     $                  13.,     1.0,    0.0,   0.2,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;     $                  14.,     0.6,    0.6,   0.6,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;     $                  15.,     0.5,    0.5,   0.7 /</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">C                               RED     Green   BLUE</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keyword">DATA</span> heatmp /     0.0,     0.0,    0.0,   0.0,</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     $                  1.,      1.0,    1.0,   1.0,</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;     $                  2.,      0.0,    0.0,   1.0,</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     $                  3.,      0.0,    0.0,   1.0,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;     $                  4.,      0.0,    0.1,   1.0,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;     $                  5.,      0.1,    0.2,   0.9,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;     $                  6.,      0.2,    0.7,   0.8,</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;     $                  7.,      0.4,    0.9,   0.6,</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     $                  8.,      0.6,    1.0,   0.4,</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     $                  9.,      0.7,    1.0,   0.3,</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     $                  10.,     0.8,    0.9,   0.2,</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;     $                  11.,     0.9,    0.7,   0.1,</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     $                  12.,     1.0,    0.2,   0.0,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     $                  13.,     1.0,    0.1,   0.0,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;     $                  14.,     1.0,    0.0,   0.0,</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;     $                  15.,     1.0,    0.0,   0.0 /</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">C                               RED     Green   BLUE</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">C</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">IF</span>(type.EQ.<span class="stringliteral">&#39;HEAT&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keywordflow">DO</span> 10 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=0,15</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;             red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= heatmp(2,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;             green(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= heatmp(3,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;             blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= heatmp(4,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;10        <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          <span class="keywordflow">DO</span> 11 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=2,15</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;             red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)  = (<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a> -2)/13.</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;             blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>) = (15-<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)/13.</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;             green(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= amin1(blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>),red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)) *2.0</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; 11          <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">IF</span>(type.EQ.<span class="stringliteral">&#39;MESH&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          <span class="keywordflow">DO</span> 20 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=0,15</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;             red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= meshmp(2,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;             green(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= meshmp(3,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;             blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)= meshmp(4,<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;20        <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">      ENDIF</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">C     scale colormap up by 61440</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">DO</span> 30 <a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>=0,15</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)=red(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)*61440.0</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;         green(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)=green(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)*61440.0</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)=blue(<a class="code" href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a>)*61440.0</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; 30   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">C     white text</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      red(1)=61440.0</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      green(1)=61440.0</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      blue(1)=61440.0</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keyword">CALL </span>xcmap(red,green,blue,15)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keyword">CALL </span><a class="code" href="lanczos_8c.html#ab7e14c80140565c8e9b50fdbf5b17995">color</a>(1)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keyword">      function </span><a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>(worldx)</div><div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">  664</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <a class="code" href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a>=worldx/1.3*windoww</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="keyword">      end</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keyword">      function </span><a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>(worldy)</div><div class="line"><a name="l00670"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">  670</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a>=abs(worldy-1.0)*(windowh - 180.0)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keyword">      end</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keyword">      function </span><a class="code" href="postnek_2xinterface_8f.html#ac9649e8bfa9588a0508ba76bde55e1c3">scoordx_inv</a>(pix)</div><div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#ac9649e8bfa9588a0508ba76bde55e1c3">  676</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">c     scoordx=worldx/1.3*windoww</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="postnek_2xinterface_8f.html#ac9649e8bfa9588a0508ba76bde55e1c3">scoordx_inv</a>=0.</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">if</span> (windoww.ne.0) <a class="code" href="postnek_2xinterface_8f.html#ac9649e8bfa9588a0508ba76bde55e1c3">scoordx_inv</a>=1.3*pix/windoww</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keyword">      end</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keyword">      function </span><a class="code" href="postnek_2xinterface_8f.html#a6440ab3efe1b6a202103ef368f1bdafe">scoordy_inv</a>(pix)</div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="postnek_2xinterface_8f.html#a6440ab3efe1b6a202103ef368f1bdafe">  684</a></span>&#160;      include <span class="stringliteral">&#39;basics.inc&#39;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">c     scoordy=abs(worldy-1.0)*(windowh - 180.0)</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="postnek_2xinterface_8f.html#a6440ab3efe1b6a202103ef368f1bdafe">scoordy_inv</a>=1. +   pix/(windowh - 180.0)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keyword">      end</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">c-----------------------------------------------------------------------</span></div><div class="ttc" id="postnek_2xinterface_8f_html_a15b1e6ead87be733cf1f84db272e6f09"><div class="ttname"><a href="postnek_2xinterface_8f.html#a15b1e6ead87be733cf1f84db272e6f09">gswrit</a></div><div class="ttdeci">subroutine gswrit(X, Y, SIZE, STRING)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00372">xinterface.f:372</a></div></div>
<div class="ttc" id="types_8h_html_a4e78ddb52240687b065c7889e7ab5b99"><div class="ttname"><a href="types_8h.html#a4e78ddb52240687b065c7889e7ab5b99">iabs</a></div><div class="ttdeci">#define iabs</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00071">types.h:71</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ae0c6177f95f334270fac9f198fd4ed4a"><div class="ttname"><a href="postnek_2xinterface_8f.html#ae0c6177f95f334270fac9f198fd4ed4a">clsseg</a></div><div class="ttdeci">subroutine clsseg</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00319">xinterface.f:319</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a22eca17c14bd8636f3cae9df2af7bda8"><div class="ttname"><a href="postnek_2xinterface_8f.html#a22eca17c14bd8636f3cae9df2af7bda8">movesc</a></div><div class="ttdeci">subroutine movesc(X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00166">xinterface.f:166</a></div></div>
<div class="ttc" id="postnek_2plot_8f_html_a1bf5e8e41f48c165cf50c832d2f8365e"><div class="ttname"><a href="postnek_2plot_8f.html#a1bf5e8e41f48c165cf50c832d2f8365e">yphy</a></div><div class="ttdeci">function yphy(YSCREN)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2plot_8f_source.html#l00299">plot.f:299</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ac9649e8bfa9588a0508ba76bde55e1c3"><div class="ttname"><a href="postnek_2xinterface_8f.html#ac9649e8bfa9588a0508ba76bde55e1c3">scoordx_inv</a></div><div class="ttdeci">function scoordx_inv(pix)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00676">xinterface.f:676</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a7b7e7625cd6f6ff7e544f40c9aa4fd03"><div class="ttname"><a href="postnek_2xinterface_8f.html#a7b7e7625cd6f6ff7e544f40c9aa4fd03">offrub</a></div><div class="ttdeci">subroutine offrub</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00358">xinterface.f:358</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a695401e16569d5d76bece71dac5e247b"><div class="ttname"><a href="postnek_2xinterface_8f.html#a695401e16569d5d76bece71dac5e247b">sgvis</a></div><div class="ttdeci">subroutine sgvis(iseg, ivisibility)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00266">xinterface.f:266</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ad2877f474c84841527bf45063eead230"><div class="ttname"><a href="postnek_2xinterface_8f.html#ad2877f474c84841527bf45063eead230">gindis</a></div><div class="ttdeci">subroutine gindis</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00262">xinterface.f:262</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a6f045724a49b3303493e5814692ba706"><div class="ttname"><a href="postnek_2xinterface_8f.html#a6f045724a49b3303493e5814692ba706">mouse</a></div><div class="ttdeci">subroutine mouse(XMOUSE, YMOUSE, BUTTON)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00071">xinterface.f:71</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ac0cb670d44c351b4b6b36e1355f129d2"><div class="ttname"><a href="postnek_2xinterface_8f.html#ac0cb670d44c351b4b6b36e1355f129d2">clrmap</a></div><div class="ttdeci">subroutine clrmap(TYPE)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00550">xinterface.f:550</a></div></div>
<div class="ttc" id="postnek_2screen_8f_html_a3e45780304d09016ede43bfed04b87ad"><div class="ttname"><a href="postnek_2screen_8f.html#a3e45780304d09016ede43bfed04b87ad">movec</a></div><div class="ttdeci">subroutine movec(X1, Y1)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2screen_8f_source.html#l00584">screen.f:584</a></div></div>
<div class="ttc" id="postnek_2plot_8f_html_a7c5267c7b190489d891d2251b0661e11"><div class="ttname"><a href="postnek_2plot_8f.html#a7c5267c7b190489d891d2251b0661e11">xscr</a></div><div class="ttdeci">function xscr(XPHYS)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2plot_8f_source.html#l00281">plot.f:281</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a7c6bc0acf46b543c61b1bcf3bf2d4aea"><div class="ttname"><a href="postnek_2xinterface_8f.html#a7c6bc0acf46b543c61b1bcf3bf2d4aea">beginb</a></div><div class="ttdeci">subroutine beginb(X1, Y1)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00239">xinterface.f:239</a></div></div>
<div class="ttc" id="postnek_2iolib_8f_html_a1e12d5f0a58f8389eff1920b1ce03e59"><div class="ttname"><a href="postnek_2iolib_8f.html#a1e12d5f0a58f8389eff1920b1ce03e59">res</a></div><div class="ttdeci">subroutine res(S1, N)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2iolib_8f_source.html#l00434">iolib.f:434</a></div></div>
<div class="ttc" id="math_8f_html_a16c41e2c6a58c051aef77bab8374b652"><div class="ttname"><a href="math_8f.html#a16c41e2c6a58c051aef77bab8374b652">ifill</a></div><div class="ttdeci">subroutine ifill(ia, ib, n)</div><div class="ttdef"><b>Definition:</b> <a href="math_8f_source.html#l00407">math.f:407</a></div></div>
<div class="ttc" id="postnek_2iolib_8f_html_ad45fc22873349f8dd5c126f3f0bd8441"><div class="ttname"><a href="postnek_2iolib_8f.html#ad45fc22873349f8dd5c126f3f0bd8441">prs</a></div><div class="ttdeci">subroutine prs(S)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2iolib_8f_source.html#l00055">iolib.f:55</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a5ed3357d34a64f0a92311b5cd074f472"><div class="ttname"><a href="postnek_2xinterface_8f.html#a5ed3357d34a64f0a92311b5cd074f472">opnseg</a></div><div class="ttdeci">subroutine opnseg(ISEG)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00323">xinterface.f:323</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a9d2cacaa7326eca04d8026bfc9db553e"><div class="ttname"><a href="postnek_2xinterface_8f.html#a9d2cacaa7326eca04d8026bfc9db553e">devini</a></div><div class="ttdeci">subroutine devini(DEVICE)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00399">xinterface.f:399</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_aae51c0482b994611d7a882c59204835f"><div class="ttname"><a href="postnek_2xinterface_8f.html#aae51c0482b994611d7a882c59204835f">scoordx</a></div><div class="ttdeci">function scoordx(worldx)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00664">xinterface.f:664</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a3a5a1a06a63d2f4da08eacd2ad4e12e2"><div class="ttname"><a href="postnek_2xinterface_8f.html#a3a5a1a06a63d2f4da08eacd2ad4e12e2">draw</a></div><div class="ttdeci">subroutine draw(X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00161">xinterface.f:161</a></div></div>
<div class="ttc" id="gen__poly__imp_8c_html_aa4abab5f762e10ba958a6bff648472dd"><div class="ttname"><a href="gen__poly__imp_8c.html#aa4abab5f762e10ba958a6bff648472dd">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="gen__poly__imp_8c_source.html#l00060">gen_poly_imp.c:60</a></div></div>
<div class="ttc" id="math_8f_html_ad7fb480cea001849621405f37167aab1"><div class="ttname"><a href="math_8f.html#ad7fb480cea001849621405f37167aab1">chcopy</a></div><div class="ttdeci">subroutine chcopy(a, b, n)</div><div class="ttdef"><b>Definition:</b> <a href="math_8f_source.html#l00436">math.f:436</a></div></div>
<div class="ttc" id="postnek_2iolib_8f_html_a759604523225e83e92645afd6606767b"><div class="ttname"><a href="postnek_2iolib_8f.html#a759604523225e83e92645afd6606767b">prsr</a></div><div class="ttdeci">subroutine prsr(S, R)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2iolib_8f_source.html#l00231">iolib.f:231</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ae0a3a2ae9aee23121a61b3802d0826df"><div class="ttname"><a href="postnek_2xinterface_8f.html#ae0a3a2ae9aee23121a61b3802d0826df">gwrite</a></div><div class="ttdeci">subroutine gwrite(X, Y, SIZE, STRING)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00362">xinterface.f:362</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_abcb68fde09eff27e4f21ef3810cd8200"><div class="ttname"><a href="postnek_2xinterface_8f.html#abcb68fde09eff27e4f21ef3810cd8200">cleara</a></div><div class="ttdeci">subroutine cleara</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00471">xinterface.f:471</a></div></div>
<div class="ttc" id="lanczos_8c_html_ab7e14c80140565c8e9b50fdbf5b17995"><div class="ttname"><a href="lanczos_8c.html#ab7e14c80140565c8e9b50fdbf5b17995">color</a></div><div class="ttdeci">int * color</div><div class="ttdef"><b>Definition:</b> <a href="lanczos_8c_source.html#l00016">lanczos.c:16</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a316de98d896ad9f6d11240c49155d919"><div class="ttname"><a href="postnek_2xinterface_8f.html#a316de98d896ad9f6d11240c49155d919">clear</a></div><div class="ttdeci">subroutine clear</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00457">xinterface.f:457</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a27cb1da06839d074efcde9d4998103ee"><div class="ttname"><a href="postnek_2xinterface_8f.html#a27cb1da06839d074efcde9d4998103ee">fillp</a></div><div class="ttdeci">subroutine fillp(ICOLOR)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00449">xinterface.f:449</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a5750532c6abc6ee8f8826bf03018684f"><div class="ttname"><a href="postnek_2xinterface_8f.html#a5750532c6abc6ee8f8826bf03018684f">findfl</a></div><div class="ttdeci">subroutine findfl(SESION, OLDVER)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00067">xinterface.f:67</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a63fa5cf04bc83798c24cb461e1480d4d"><div class="ttname"><a href="postnek_2xinterface_8f.html#a63fa5cf04bc83798c24cb461e1480d4d">gnable</a></div><div class="ttdeci">subroutine gnable</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00258">xinterface.f:258</a></div></div>
<div class="ttc" id="postnek_2plot_8f_html_aa6e27b432aef95cb707060fe995d2c08"><div class="ttname"><a href="postnek_2plot_8f.html#aa6e27b432aef95cb707060fe995d2c08">initps</a></div><div class="ttdeci">subroutine initps</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2plot_8f_source.html#l01586">plot.f:1586</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a21c6581ab8e6c8b00b145d9154e97857"><div class="ttname"><a href="postnek_2xinterface_8f.html#a21c6581ab8e6c8b00b145d9154e97857">penw</a></div><div class="ttdeci">subroutine penw(IWIDTH)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00331">xinterface.f:331</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a20a0d5df1d6d4e82ccd41605af3070d4"><div class="ttname"><a href="postnek_2xinterface_8f.html#a20a0d5df1d6d4e82ccd41605af3070d4">delseg</a></div><div class="ttdeci">subroutine delseg(ISEG)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00327">xinterface.f:327</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a426f6a66b6bd76fb526ac94861bcd52e"><div class="ttname"><a href="postnek_2xinterface_8f.html#a426f6a66b6bd76fb526ac94861bcd52e">mainf</a></div><div class="ttdeci">program mainf</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00001">xinterface.f:1</a></div></div>
<div class="ttc" id="postnek_2plot_8f_html_a4ec54acb6421be2555cd3efe39ba3510"><div class="ttname"><a href="postnek_2plot_8f.html#a4ec54acb6421be2555cd3efe39ba3510">xphy</a></div><div class="ttdeci">function xphy(XSCREN)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2plot_8f_source.html#l00293">plot.f:293</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a5d1d5eed3065d1ccf65bb3d010226db0"><div class="ttname"><a href="postnek_2xinterface_8f.html#a5d1d5eed3065d1ccf65bb3d010226db0">endp</a></div><div class="ttdeci">subroutine endp</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00434">xinterface.f:434</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_af4175a8271d4629a40d42ae159daac36"><div class="ttname"><a href="postnek_2xinterface_8f.html#af4175a8271d4629a40d42ae159daac36">move</a></div><div class="ttdeci">subroutine move(X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00156">xinterface.f:156</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ace50d35a4d95824d5c9c6f948a90eb05"><div class="ttname"><a href="postnek_2xinterface_8f.html#ace50d35a4d95824d5c9c6f948a90eb05">heject</a></div><div class="ttdeci">subroutine heject</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00270">xinterface.f:270</a></div></div>
<div class="ttc" id="postnek_2plot_8f_html_ac1101d6cdf0422a116a79b4da4cb5947"><div class="ttname"><a href="postnek_2plot_8f.html#ac1101d6cdf0422a116a79b4da4cb5947">yscr</a></div><div class="ttdeci">function yscr(YPHYS)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2plot_8f_source.html#l00287">plot.f:287</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_aeab7bd96074585409ad27f123844bca5"><div class="ttname"><a href="postnek_2xinterface_8f.html#aeab7bd96074585409ad27f123844bca5">devex</a></div><div class="ttdeci">subroutine devex</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00424">xinterface.f:424</a></div></div>
<div class="ttc" id="postnek_2screen_8f_html_aec8a2fb255b1dfc7e4fe074bde83b491"><div class="ttname"><a href="postnek_2screen_8f.html#aec8a2fb255b1dfc7e4fe074bde83b491">filter</a></div><div class="ttdeci">subroutine filter(XMOUSE, YMOUSE, XSCREEN, YSCREEN)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2screen_8f_source.html#l00733">screen.f:733</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a6440ab3efe1b6a202103ef368f1bdafe"><div class="ttname"><a href="postnek_2xinterface_8f.html#a6440ab3efe1b6a202103ef368f1bdafe">scoordy_inv</a></div><div class="ttdeci">function scoordy_inv(pix)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00684">xinterface.f:684</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_aca8979e3f74809654f66e0294f7dde7b"><div class="ttname"><a href="postnek_2xinterface_8f.html#aca8979e3f74809654f66e0294f7dde7b">drawsc</a></div><div class="ttdeci">subroutine drawsc(X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00192">xinterface.f:192</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a596f66905e108f0c942d832dc3f7b31c"><div class="ttname"><a href="postnek_2xinterface_8f.html#a596f66905e108f0c942d832dc3f7b31c">reader</a></div><div class="ttdeci">subroutine reader(VALUE, IERR)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00018">xinterface.f:18</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a910f02566c930fd32f763e48d2435501"><div class="ttname"><a href="postnek_2xinterface_8f.html#a910f02566c930fd32f763e48d2435501">scoordy</a></div><div class="ttdeci">function scoordy(worldy)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00670">xinterface.f:670</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_ae90c289bf6fbea3bd3aca5392a653718"><div class="ttname"><a href="postnek_2xinterface_8f.html#ae90c289bf6fbea3bd3aca5392a653718">rubber</a></div><div class="ttdeci">subroutine rubber</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00354">xinterface.f:354</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a38427b6d929242043fdbf5db9659829a"><div class="ttname"><a href="postnek_2xinterface_8f.html#a38427b6d929242043fdbf5db9659829a">beginp</a></div><div class="ttdeci">subroutine beginp(X1, Y1)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00218">xinterface.f:218</a></div></div>
<div class="ttc" id="postnek_2xinterface_8f_html_a193d34f29f39adf341ebfb71fadede70"><div class="ttname"><a href="postnek_2xinterface_8f.html#a193d34f29f39adf341ebfb71fadede70">openf</a></div><div class="ttdeci">subroutine openf(IUNIT, FILE, STATUS, ITYPE, IERR)</div><div class="ttdef"><b>Definition:</b> <a href="postnek_2xinterface_8f_source.html#l00035">xinterface.f:35</a></div></div>
<div class="ttc" id="structfile_html"><div class="ttname"><a href="structfile.html">file</a></div><div class="ttdef"><b>Definition:</b> <a href="amg_8c_source.html#l00706">amg.c:706</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_890cbfca5a2c984a656da990ef30c73b.html">Nek5000</a></li><li class="navelem"><a class="el" href="dir_cce85a060d2dd86e02527419f0eb9d68.html">tools</a></li><li class="navelem"><a class="el" href="dir_9504359e7f6e822df5a7d4ac4ea5481f.html">postnek</a></li><li class="navelem"><a class="el" href="postnek_2xinterface_8f.html">xinterface.f</a></li>
    <li class="footer">Generated on Tue Jan 24 2017 16:27:11 for KTH framework for Nek5000 toolboxes; testing version by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
